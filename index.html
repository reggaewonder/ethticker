<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ETH Ticker & News</title>
    <script src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>
    <style>
        :root { --bg: #0b0e11; --card: #181a20; --text: #eaecef; --green: #02c076; --red: #cf304a; --border: #2b2f36; }
        body { background: var(--bg); color: var(--text); font-family: 'Inter', sans-serif; margin: 0; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        
        /* Layout */
        .header { padding: 15px 25px; background: var(--card); border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
        .main-container { display: flex; flex: 1; overflow: hidden; }
        
        /* Left Column: Chart & Stats */
        .content-left { flex: 3; display: flex; flex-direction: column; padding: 20px; overflow-y: auto; }
        .main-price { font-size: 3rem; font-weight: bold; font-family: monospace; }
        .stats-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin: 20px 0; }
        .stat-card { background: var(--card); padding: 12px; border-radius: 4px; border: 1px solid var(--border); }
        .stat-label { color: #848e9c; font-size: 0.75rem; margin-bottom: 4px; }
        
        /* Right Column: News Sidebar */
        .sidebar-news { flex: 1; background: var(--card); border-left: 1px solid var(--border); display: flex; flex-direction: column; min-width: 320px; }
        .sidebar-header { padding: 15px; font-weight: bold; border-bottom: 1px solid var(--border); background: #202226; }
        #news-feed { flex: 1; overflow-y: auto; padding: 10px; }
        .news-item { padding: 12px; border-bottom: 1px solid var(--border); font-size: 0.9rem; transition: background 0.2s; }
        .news-item:hover { background: #2b2f36; cursor: pointer; }
        .news-item a { color: var(--text); text-decoration: none; }
        .news-time { font-size: 0.7rem; color: #848e9c; display: block; margin-top: 5px; }

        .up { color: var(--green); }
        .down { color: var(--red); }
        
        @media (max-width: 900px) {
            .main-container { flex-direction: column; overflow-y: auto; }
            .sidebar-news { border-left: none; border-top: 1px solid var(--border); height: 400px; }
        }
    </style>
</head>
<body>

    <div class="header">
        <div>
            <div style="color: #848e9c; font-size: 0.8rem; font-weight: bold;">ETHEREUM / USD</div>
            <div id="price" class="main-price">Loading...</div>
        </div>
        <div id="change-pct" style="font-size: 1.5rem; font-weight: bold;">0.00%</div>
    </div>

    <div class="main-container">
        <div class="content-left">
            <div class="stats-grid">
                <div class="stat-card"><div class="stat-label">24h High</div><div id="high" style="font-weight:bold;">--</div></div>
                <div class="stat-card"><div class="stat-label">24h Low</div><div id="low" style="font-weight:bold;">--</div></div>
                <div class="stat-card"><div class="stat-label">24h Vol</div><div id="vol" style="font-weight:bold;">--</div></div>
            </div>
            <div id="chart-container" style="flex:1; min-height: 400px;"></div>
        </div>

        <div class="sidebar-news">
            <div class="sidebar-header">LATEST ETH NEWS</div>
            <div id="news-feed">Fetching news...</div>
        </div>
    </div>

    <script>
        let lastPrice = 0;
        let chart, lineSeries;

        function initChart() {
            const container = document.getElementById('chart-container');
            chart = LightweightCharts.createChart(container, {
                layout: { background: { color: '#181a20' }, textColor: '#d1d4dc' },
                grid: { vertLines: { color: '#2b2f36' }, horzLines: { color: '#2b2f36' } },
                width: container.clientWidth,
                height: container.clientHeight,
                timeScale: { timeVisible: true, secondsVisible: true }
            });
            lineSeries = chart.addAreaSeries({ lineColor: '#02c076', topColor: 'rgba(2, 192, 118, 0.4)', bottomColor: 'rgba(2, 192, 118, 0.0)', lineWidth: 2 });
        }

        async function updateTicker() {
            try {
                const res = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=ethereum&vs_currencies=usd&include_24hr_vol=true&include_24hr_high_low=true&include_24hr_change=true');
                const data = await res.json();
                const eth = data.ethereum;
                
                document.getElementById('price').innerText = `$${eth.usd.toLocaleString()}`;
                document.getElementById('price').style.color = eth.usd >= lastPrice ? '#02c076' : '#cf304a';
                lastPrice = eth.usd;

                document.getElementById('high').innerText = `$${eth.usd_24h_high.toLocaleString()}`;
                document.getElementById('low').innerText = `$${eth.usd_24h_low.toLocaleString()}`;
                document.getElementById('vol').innerText = `$${Math.round(eth.usd_24h_vol).toLocaleString()}`;
                
                const pct = eth.usd_24h_change;
                document.getElementById('change-pct').innerText = `${pct.toFixed(2)}%`;
                document.getElementById('change-pct').className = pct >= 0 ? 'up' : 'down';

                lineSeries.update({ time: Math.floor(Date.now() / 1000), value: eth.usd });
            } catch (e) { console.error(e); }
        }

        async function updateNews() {
            try {
                // Using CryptoPanic public RSS-to-JSON proxy or similar for demo
                const res = await fetch('https://api.rss2json.com/v1/api.json?rss_url=https://cryptopanic.com/news/rss/ethereum/');
                const data = await res.json();
                const feed = document.getElementById('news-feed');
                feed.innerHTML = '';
                
                data.items.slice(0, 15).forEach(item => {
                    const div = document.createElement('div');
                    div.className = 'news-item';
                    div.innerHTML = `<a href="${item.link}" target="_blank">${item.title}</a><span class="news-time">${item.pubDate}</span>`;
                    feed.appendChild(div);
                });
            } catch (e) { document.getElementById('news-feed').innerText = "News temporarily unavailable"; }
        }

        initChart();
        updateTicker();
        updateNews();
        setInterval(updateTicker, 10000);
        setInterval(updateNews, 300000); // News updates every 5 mins

        window.addEventListener('resize', () => {
            const container = document.getElementById('chart-container');
            chart.applyOptions({ width: container.clientWidth, height: container.clientHeight });
        });
    </script>
</body>
</html>
